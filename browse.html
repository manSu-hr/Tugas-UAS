<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jelajahi - Nonton Bareng MS</title>
    <link rel="icon" type="image/svg+xml"
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect fill='%23ff4757' rx='15' width='100' height='100'/><text x='50' y='65' font-size='50' text-anchor='middle' fill='white' font-family='Arial' font-weight='bold'>MS</text></svg>">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/components.css">
</head>

<body>
    <!-- Navbar -->
    <nav class="navbar scrolled">
        <div class="navbar-container">
            <a href="index.html" class="navbar-brand">
                <div class="navbar-logo">MS</div>
                <h1 class="navbar-title">Nonton <span>Bareng</span></h1>
            </a>
            <div class="navbar-menu">
                <ul class="navbar-links">
                    <li><a href="index.html" class="navbar-link">Beranda</a></li>
                    <li><a href="browse.html" class="navbar-link active">Jelajahi</a></li>
                    <li><a href="browse.html?type=anime" class="navbar-link">Anime</a></li>
                    <li><a href="browse.html?type=donghua" class="navbar-link">Donghua</a></li>
                    <li><a href="browse.html?type=drama" class="navbar-link">Drama China</a></li>
                </ul>
                <div class="navbar-actions">
                    <div class="search-box">
                        <svg class="search-icon" width="18" height="18" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2">
                            <circle cx="11" cy="11" r="8" />
                            <path d="M21 21l-4.35-4.35" />
                        </svg>
                        <input type="text" class="search-input" id="searchInput"
                            placeholder="Cari anime, donghua, drama...">
                    </div>
                    <button class="settings-btn theme-btn"><svg width="20" height="20" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2">
                            <path
                                d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
                        </svg></button>
                    <div class="lang-dropdown">
                        <button class="settings-btn lang-btn"><svg width="20" height="20" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10" />
                                <path d="M2 12h20" />
                            </svg></button>
                        <div class="lang-dropdown-menu">
                            <div class="lang-option active" data-lang="id">ðŸ‡®ðŸ‡© Indonesia</div>
                            <div class="lang-option" data-lang="en">ðŸ‡ºðŸ‡¸ English</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Browse Page -->
    <main class="section" style="padding-top: 100px;">
        <div class="container">
            <h1 style="margin-bottom: var(--space-xl);" id="pageTitle">Jelajahi Koleksi</h1>

            <!-- Filters -->
            <div class="filters-bar">
                <div class="filter-group">
                    <label class="filter-label">Tipe</label>
                    <select class="filter-select" id="filterType">
                        <option value="">Semua</option>
                        <option value="anime">Anime</option>
                        <option value="donghua">Donghua</option>
                        <option value="drama">Drama China</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label class="filter-label">Status</label>
                    <select class="filter-select" id="filterStatus">
                        <option value="">Semua</option>
                        <option value="ongoing">Ongoing</option>
                        <option value="completed">Completed</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label class="filter-label">Tahun</label>
                    <select class="filter-select" id="filterYear">
                        <option value="">Semua</option>
                        <option value="2025">2025</option>
                        <option value="2024">2024</option>
                        <option value="2023">2023</option>
                        <option value="2022">2022</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label class="filter-label">Urutkan</label>
                    <select class="filter-select" id="filterSort">
                        <option value="rating">Rating Tertinggi</option>
                        <option value="newest">Terbaru</option>
                        <option value="title">Judul A-Z</option>
                    </select>
                </div>
            </div>

            <!-- Genre Tags -->
            <div class="filter-tags" style="margin-bottom: var(--space-xl);" id="genreTags">
                <span class="filter-tag active" data-genre="">Semua Genre</span>
                <span class="filter-tag" data-genre="Action">Action</span>
                <span class="filter-tag" data-genre="Romance">Romance</span>
                <span class="filter-tag" data-genre="Fantasy">Fantasy</span>
                <span class="filter-tag" data-genre="Comedy">Comedy</span>
                <span class="filter-tag" data-genre="Drama">Drama</span>
                <span class="filter-tag" data-genre="Adventure">Adventure</span>
                <span class="filter-tag" data-genre="Supernatural">Supernatural</span>
                <span class="filter-tag" data-genre="Mystery">Mystery</span>
            </div>

            <!-- Results -->
            <div class="cards-grid stagger" id="resultsGrid"></div>

            <!-- Empty State -->
            <div class="text-center" id="emptyState" style="display: none; padding: var(--space-3xl);">
                <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="var(--text-muted)"
                    stroke-width="1.5" style="margin-bottom: var(--space-lg);">
                    <circle cx="11" cy="11" r="8" />
                    <path d="M21 21l-4.35-4.35" />
                </svg>
                <h3 class="text-muted">Tidak ada hasil ditemukan</h3>
                <p class="text-muted">Coba ubah filter atau kata kunci pencarian</p>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-bottom" style="border: none; margin: 0; padding: var(--space-lg) 0;">
                <p class="footer-copyright">Â© 2026 Nonton Bareng MS. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script src="js/data.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/app.js"></script>
    <script>
        class BrowsePage {
            constructor() {
                this.params = new URLSearchParams(window.location.search);
                this.filters = {
                    type: this.params.get('type') || '',
                    status: this.params.get('status') || '',
                    year: this.params.get('year') || '',
                    genre: this.params.get('genre') || '',
                    sort: this.params.get('sort') || 'rating',
                    search: this.params.get('search') || ''
                };
                this.init();
            }

            init() {
                this.applyInitialFilters();
                this.setupFilters();
                this.render();
            }

            applyInitialFilters() {
                document.getElementById('filterType').value = this.filters.type;
                document.getElementById('filterStatus').value = this.filters.status;
                document.getElementById('filterYear').value = this.filters.year;
                document.getElementById('filterSort').value = this.filters.sort;
                document.getElementById('searchInput').value = this.filters.search;

                document.querySelectorAll('.filter-tag').forEach(tag => {
                    tag.classList.toggle('active', tag.dataset.genre === this.filters.genre);
                });

                if (this.filters.type) {
                    const titles = { anime: 'Anime Jepang', donghua: 'Donghua China', drama: 'Drama China' };
                    document.getElementById('pageTitle').textContent = titles[this.filters.type] || 'Jelajahi Koleksi';
                }
            }

            setupFilters() {
                document.getElementById('filterType').addEventListener('change', (e) => { this.filters.type = e.target.value; this.render(); });
                document.getElementById('filterStatus').addEventListener('change', (e) => { this.filters.status = e.target.value; this.render(); });
                document.getElementById('filterYear').addEventListener('change', (e) => { this.filters.year = e.target.value; this.render(); });
                document.getElementById('filterSort').addEventListener('change', (e) => { this.filters.sort = e.target.value; this.render(); });

                document.getElementById('searchInput').addEventListener('input', (e) => {
                    this.filters.search = e.target.value;
                    this.render();
                });

                document.querySelectorAll('.filter-tag').forEach(tag => {
                    tag.addEventListener('click', () => {
                        document.querySelectorAll('.filter-tag').forEach(t => t.classList.remove('active'));
                        tag.classList.add('active');
                        this.filters.genre = tag.dataset.genre;
                        this.render();
                    });
                });
            }

            getFilteredContent() {
                let content = [...AppData.allContent];

                if (this.filters.search) {
                    const q = this.filters.search.toLowerCase();
                    content = content.filter(c => c.title.toLowerCase().includes(q));
                }
                if (this.filters.type) content = content.filter(c => c.type === this.filters.type);
                if (this.filters.status) content = content.filter(c => c.status === this.filters.status);
                if (this.filters.year) content = content.filter(c => c.year === parseInt(this.filters.year));
                if (this.filters.genre) content = content.filter(c => c.genre.includes(this.filters.genre));

                switch (this.filters.sort) {
                    case 'rating': content.sort((a, b) => b.rating - a.rating); break;
                    case 'newest': content.sort((a, b) => b.year - a.year); break;
                    case 'title': content.sort((a, b) => a.title.localeCompare(b.title)); break;
                }

                return content;
            }

            render() {
                const content = this.getFilteredContent();
                const grid = document.getElementById('resultsGrid');
                const empty = document.getElementById('emptyState');

                if (content.length === 0) {
                    grid.innerHTML = '';
                    empty.style.display = 'block';
                    return;
                }

                empty.style.display = 'none';
                grid.innerHTML = content.map(item => this.createCard(item)).join('');

                grid.querySelectorAll('.content-card').forEach(card => {
                    card.addEventListener('click', () => window.location.href = `detail.html?id=${card.dataset.id}`);
                });
            }

            createCard(item) {
                const badgeHtml = item.hasDubbing
                    ? '<span class="card-badge badge-dub">DUB ID</span>'
                    : '<span class="card-badge badge-sub">SUB ID</span>';

                return `
          <div class="content-card" data-id="${item.id}">
            <div class="card-image">
              <img src="${item.cover}" alt="${item.title}" loading="lazy">
              <div class="card-overlay">
                <div class="card-play-btn">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="white"><path d="M8 5v14l11-7z"/></svg>
                </div>
              </div>
              <div class="card-badges">
                <span class="card-badge badge-hd">HD</span>
                ${badgeHtml}
              </div>
            </div>
            <div class="card-info">
              <h4 class="card-title">${item.title}</h4>
              <div class="card-meta">
                <span class="card-rating">
                  <svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                  ${item.rating}
                </span>
                <span>${item.year}</span>
                <span>${item.status === 'ongoing' ? `Ep ${item.currentEpisode}` : 'Tamat'}</span>
              </div>
            </div>
          </div>
        `;
            }
        }

        new BrowsePage();
    </script>
</body>

</html>